local DAMAGE_PER_TICK = 5       -- How much health to drain each tick
local TICK_DELAY = 1            -- Time between each damage tick
local part = script.Parent

local playersInZone = {}        -- Tracks players currently touching the zone


-- Function to start draining health for a player
local function startDraining(player)
	if playersInZone[player] then return end  -- Debounce: already draining

	playersInZone[player] = true

	task.spawn(function()
		while playersInZone[player] do
			local character = player.Character
			local humanoid = character and character:FindFirstChild("Humanoid")
			
			if humanoid then
				-- Reduce health safely
				humanoid:TakeDamage(DAMAGE_PER_TICK)
			end
			
			task.wait(TICK_DELAY)
		end
	end)
end


-- Detect when something touches the part
part.Touched:Connect(function(hit)
	local character = hit.Parent
	if not character then return end
	
	local humanoid = character:FindFirstChild("Humanoid")
	if not humanoid then return end

	local player = game.Players:GetPlayerFromCharacter(character)
	if not player then return end

	startDraining(player)
end)


-- Detect when a player leaves the part
part.TouchEnded:Connect(function(hit)
	local character = hit.Parent
	if not character then return end
	
	local player = game.Players:GetPlayerFromCharacter(character)
	if not player then return end

	-- Stop draining when they leave
	playersInZone[player] = nil
end)
